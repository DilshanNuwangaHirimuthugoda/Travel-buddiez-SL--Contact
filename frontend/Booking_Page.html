<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Travel Buddiezs SL - Book Your Trip</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">
  <!-- EmailJS SDK -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
  <style>
    :root{
      --bg:#f6f9fcba;
      --card: rgba(57, 72, 55, 0.3);
      --primary: rgba(24, 31, 23, 0.2);
      --muted:#141719;
      --accent:linear-gradient(90deg,#0b69d6 0%,#24aec7 100%);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body {
      font-family: 'Inter', system-ui, sans-serif;
      background: var(--bg);
      color: #0f172a;
      min-height: 100vh;
    }
    body::before{
      content: '';
      position: fixed;
      inset: 0;
      z-index: -1;
      background: url('bg7.jpg') center center/cover no-repeat;
      opacity: 0.78;
      filter: saturate(1.02) contrast(1.02) brightness(0.92);
    }
    header {
      background: var(--primary);
      color: #fff;
      padding: 28px 16px;
      text-align: center;
      font-size: 28px;
      font-weight: 800;
      letter-spacing: -0.5px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      font-family: 'Poppins', sans-serif;
      text-transform: uppercase;
    }
    .logo {width: 70px;height: 70px;object-fit: contain;}
    .container {
      width: 92%;
      max-width: 980px;
      margin: 28px auto;
      background: var(--card);
      padding: 32px;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(2,6,23,0.08);
      border: 1px solid rgba(15,23,42,0.03);
      backdrop-filter: blur(8px);
    }
    h2{font-size:24px;margin-bottom:12px;font-weight:700}
    .form-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:18px;align-items:end}
    .field{display:flex;flex-direction:column}
    .field.full{grid-column:1/-1}
    label{font-weight:600;margin-bottom:8px;color:#eff1f5e8}
    input,select,textarea{
      padding:12px 14px;
      border-radius:12px;
      border:2px solid rgba(15,23,42,0.12);
      background:#ffffff88;
      font-size:0.95rem;
      transition:all .2s;
    }
    input:focus,select:focus,textarea:focus{
      outline:none;border-color:#0b69d6;
      box-shadow:0 0 0 4px rgba(11,105,214,0.15);
    }
    .package-wrap{position:relative}
    .package-input{padding-right:44px !important}
    .dropdown-toggle{position:absolute;right:8px;top:50%;transform:translateY(-50%);background:none;border:none;font-size:20px;cursor:pointer}
    .dropdown-list{
      position:absolute;left:0;right:0;top:calc(100% + 8px);
      background:#fff;border-radius:12px;
      box-shadow:0 12px 35px rgba(0,0,0,0.15);
      max-height:220px;overflow:auto;z-index:50;
      opacity:0;pointer-events:none;transform:translateY(-10px);transition:all .2s;
    }
    .dropdown-list.show{opacity:1;pointer-events:auto;transform:translateY(0)}
    .dropdown-item{padding:10px 14px;cursor:pointer;border-radius:8px;margin:4px}
    .dropdown-item:hover{background:rgba(11,105,214,0.1)}

    button{
      padding:14px 28px;border:none;border-radius:12px;
      background:var(--accent);color:#fff;font-weight:700;font-size:1.1rem;
      cursor:pointer;box-shadow:0 8px 25px rgba(11,105,214,0.2);
      transition:all .2s;
    }
    button:hover{transform:translateY(-3px);box-shadow:0 12px 30px rgba(11,105,214,0.3)}

    .success, .receipt{
      margin-top:20px;padding:18px;border-radius:12px;display:none;
    }
    .success{background:#ecfdf5;color:#065f46;border:1px solid #86efac}
    .receipt{background:#fff;border:1px solid #e2e8f0;padding:24px;border-radius:12px;font-size:0.95rem}

    @media (max-width:720px){.form-grid{grid-template-columns:1fr}}




  .snow {
  position: fixed;
  top: -10px;
  color: rgb(127, 183, 223);
  font-size: 1em;
  user-select: none;
  pointer-events: none;
  animation: fall linear infinite;
}

@keyframes fall {
  to {
    transform: translateY(100vh);
  }
}




  </style>
</head>
<body>

<header>
  <img src="logo.png" alt="Travel Buddiezs SL" class="logo">
  Travel Buddiezs SL
</header>

<div class="container">
  <h2>Book Your Trip</h2>
  <p class="lead" style="color:var(--muted);margin-bottom:24px;">Fill in the details and we‚Äôll confirm your adventure instantly!</p>

  <form id="bookingForm">
    <div class="form-grid">
      <!-- All your existing fields (same as before) -->
      <div class="field"><label for="name">Full Name</label><input type="text" id="name" required></div>
      <div class="field"><label for="email">Email Address</label><input type="email" id="email" required></div>
      <div class="field"><label for="phone">Phone Number</label><input type="text" id="phone" required></div>
      <div class="field"><label for="whatsapp">WhatsApp Number</label><input type="text" id="whatsapp" required placeholder="94xxxxxxxxx"></div>
      <div class="field"><label for="pickup">Pickup Location</label><input type="text" id="pickup" required></div>
      <div class="field"><label for="drop">Drop Location</label><input type="text" id="drop" required></div>

      <div class="field">
        <label for="package">Select Package</label>
        <div class="package-wrap">
          <input id="package" class="package-input" placeholder="Type or choose package" autocomplete="off" required>
          <button type="button" class="dropdown-toggle" aria-label="Toggle">‚ñæ</button>
          <ul class="dropdown-list">
            <li class="dropdown-item" data-value="Sigiriya Day Tour">Sigiriya Day Tour</li>
            <li class="dropdown-item" data-value="Kandy City Tour">Kandy City Tour</li>
            <li class="dropdown-item" data-value="Ella Adventure Tour">Ella Adventure Tour</li>
            <li class="dropdown-item" data-value="Galle Dutch Fort Tour">Galle Dutch Fort Tour</li>
          </ul>
        </div>
      </div>

      <div class="field"><label for="date">Travel Date</label><input type="date" id="date" required></div>
      <div class="field"><label for="time">Travel Time</label><input type="time" id="time" required></div>
      <div class="field"><label for="vehicle">Vehicle Type</label>
        <select id="vehicle" required>
          <option value="">Select Vehicle</option>
          <option>Economy Car</option>
          <option>SUV</option>
          <option>Van</option>
          <option>Luxury Car</option>
        </select>
      </div>
      <div class="field"><label for="travelers">Number of Travelers</label><input type="number" id="travelers" min="1" required></div>
      <div class="field full"><label for="message">Special Requests (Optional)</label><textarea id="message"></textarea></div>

      <div class="field full" style="text-align:center;margin-top:12px;">
        <button type="submit">Submit Booking</button>
      </div>
    </div>
  </form>

  <div id="successMsg" class="success">
    <strong>Thank you!</strong> Your booking is confirmed. Check your WhatsApp & Email for the receipt.
  </div>

  <div id="receiptPreview" class="receipt"></div>
</div>

<!-- EmailJS Initialization (Replace with your own keys) -->
<script type="text/javascript">
  (function(){
    emailjs.init("fSjft8hXRKgA3FnL-"); // ‚Üê Get this free from emailjs.com
  })();
</script>

<script>
  // === 1. Package Dropdown (unchanged) ===
  (function(){
    const packages = ['Sigiriya Day Tour','Kandy City Tour','Ella Adventure Tour','Galle Dutch Fort Tour'];
    const wrap = document.querySelector('.package-wrap');
    const input = wrap.querySelector('#package');
    const toggle = wrap.querySelector('.dropdown-toggle');
    const list = wrap.querySelector('.dropdown-list');

    const build = (items) => list.innerHTML = items.map(v=>`<li class="dropdown-item" data-value="${vtyw(v)}">${v}</li>`).join('');
    const open = () => { build(packages); list.classList.add('show'); }
    const close = () => list.classList.remove('show');

    input.addEventListener('input', () => {
      const q = input.value.toLowerCase();
      build(packages.filter(p=>p.toLowerCase().includes(q)));
      open();
    });
    input.addEventListener('focus', open);
    toggle.addEventListener('click', ()=> list.classList.contains('show') ? close() : open());
    list.addEventListener('click', e=>{
      const item = e.target.closest('.dropdown-item');
      if(item){ input.value = item.dataset.value; close(); }
    });
    document.addEventListener('click', e=>{ if(!wrap.contains(e.target)) close(); });
  })();

  // === 2. Main Submit Logic ===
  document.getElementById("bookingForm").addEventListener("submit", function(e) {
    e.preventDefault();

    const d = {
      name: document.getElementById("name").value.trim(),
      email: document.getElementById("email").value.trim(),
      phone: document.getElementById("phone").value.trim(),
      whatsapp: document.getElementById("whatsapp").value.trim().replace(/\D/g,''), // numbers only
      pickup: document.getElementById("pickup").value.trim(),
      drop: document.getElementById("drop").value.trim(),
      package: document.getElementById("package").value.trim(),
      date: document.getElementById("date").value,
      time: document.getElementById("time").value,
      vehicle: document.getElementById("vehicle").value,
      travelers: document.getElementById("travelers").value,
      message: document.getElementById("message").value.trim()
    };

    // Generate beautiful receipt text
    const receiptText = `
üåü *Thank You ${d.name}! Your Trip is Confirmed* üåü

*Booking Details*
üì¶ Package: ${d.package}
üöï Vehicle: ${d.vehicle}
üìç Pickup: ${d.pickup}
üéØ Drop: ${d.drop}
üìÖ Date: ${new Date(d.date).toLocaleDateString('en-GB')}
üïê Time: ${d.time}
üë• Travelers: ${d.travelers}
üí¨ Special Requests: ${d.message || 'None'}

We‚Äôll pick you up on time! Safe travels with Travel Buddiezs SL üöå

Need help? Reply to this message or call +94 754727650
    `.trim();

    const receiptHTML = receiptText.replace(/\n/g, '<br>').replace(/\*(.*?)\*/g, '<strong>$1</strong>');

    // Show receipt on page
    document.getElementById("receiptPreview").innerHTML = `<h3 style="margin-bottom:12px">Your Booking Receipt</h3><div style="line-height:1.7">${receiptHTML}</div>`;
    document.getElementById("successMsg").style.display = "block";
    document.getElementById("receiptPreview").style.display = "block";

    // === Send Email via EmailJS ===
    emailjs.send("service_poujvkh", "template_0p0yzpa", {
      to_name: d.name,
      to_email: d.email,
      receipt: receiptText,
      whatsapp: d.whatsapp
    }).then(() => console.log("Email sent"))
      .catch(err => console.error("EmailJS error:", err));

    // === Open WhatsApp with pre-filled message (mobile + desktop) ===
    const waText = encodeURIComponent(receiptText);
    const waNumber = d.whatsapp.startsWith('94') ? d.whatsapp : '94' + d.whatsapp.replace(/^0/, '');
   const waURL = `https://wa.me/94754727650?text=${waText}`; // ‚Üê Change 94XXXXXXXXX to your business number
    window.open(waURL, "_blank");

    // Reset form
    this.reset();
  });
</script>

<!-- === . Snow Animation === -->

<script>
function createSnow() {
  const snow = document.createElement("div");
  snow.className = "snow";
  snow.innerHTML = "‚ùÑ";

  snow.style.left = Math.random() * window.innerWidth + "px";
  snow.style.fontSize = (10 + Math.random() * 20) + "px";

  snow.style.animationDuration = (3 + Math.random() * 5) + "s";
  snow.style.opacity = Math.random();

  document.body.appendChild(snow);

  setTimeout(() => {
    snow.remove();
  }, 8000);
}

setInterval(createSnow, 200);
</script>

<!-- === . Snow Animation === -->

</body>
</html>